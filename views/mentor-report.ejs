<!DOCTYPE html>
<html lang="en">

<head>
	<title>SVCE Kadapa</title>
	<meta charset="utf-8" />
	<meta name="description" content="svce faculty feedback portal" />
	<meta name="keywords" content="svcekadapa svce svck kadapa" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="shortcut icon" href="/favicon.ico" />
	<!--begin::Fonts-->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />
	<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css'>
	<script src="https://unpkg.com/xlsx/dist/shim.min.js"></script>
	<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
	<!--end::Fonts-->
	<!--begin::Global Stylesheets Bundle(used by all pages)-->
	<link href="/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
	<link href="/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
	<script src="https://www.google.com/jsapi"></script>
	<!--end::Global Stylesheets Bundle-->
</head>
<!--end::Head-->
<!--begin::Body-->

<body id="kt_body" class="header-fixed header-tablet-and-mobile-fixed aside-enabled sidebar-enabled">
	<!--begin::Main-->
	<!--begin::Root-->
	<div class="d-flex flex-column flex-root">
		<!--begin::Page-->
		<div class="page d-flex flex-column flex-column-fluid">
			<!--begin::Header-->
			<div id="kt_header" class="header align-items-stretch">
				<!--begin::Container-->
				<div class="container-xxl d-flex align-items-stretch justify-content-between">
					<!--begin::Brand-->
					<div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0 w-lg-225px me-5">
						<!--begin::Aside mobile toggle-->
						<div class="btn btn-icon btn-active-icon-primary ms-n2 me-2 d-flex d-lg-none"
							id="kt_aside_toggle">
							<!--begin::Svg Icon | path: icons/duotune/abstract/abs015.svg-->
							<span class="svg-icon svg-icon-1">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
									fill="none">
									<path
										d="M21 7H3C2.4 7 2 6.6 2 6V4C2 3.4 2.4 3 3 3H21C21.6 3 22 3.4 22 4V6C22 6.6 21.6 7 21 7Z"
										fill="black" />
									<path opacity="0.3"
										d="M21 14H3C2.4 14 2 13.6 2 13V11C2 10.4 2.4 10 3 10H21C21.6 10 22 10.4 22 11V13C22 13.6 21.6 14 21 14ZM22 20V18C22 17.4 21.6 17 21 17H3C2.4 17 2 17.4 2 18V20C2 20.6 2.4 21 3 21H21C21.6 21 22 20.6 22 20Z"
										fill="black" />
								</svg>
							</span>
							<!--end::Svg Icon-->
						</div>
						<!--end::Aside mobile toggle-->
						<!--begin::Logo-->
						<a href="#">
							<img alt="Logo" src="/assets/media/logos/svce.png" class="d-none d-lg-inline h-50px" />
							<img alt="Logo" src="/assets/media/logos/svce.png" class="d-lg-none h-35px" />
						</a>
						<!--end::Logo-->
					</div>
					<!--end::Brand-->
					<!--begin::Wrapper-->
					<div class="d-flex align-items-stretch justify-content-between ml-auto">
						<!--begin::Toolbar wrapper-->
						<div class="d-flex align-items-stretch flex-shrink-0">
							<!--begin::Search-->
							<div class="d-flex align-items-stretch ms-1 ms-lg-2">
								<!--begin::Search-->
								<div id="kt_header_search" class="d-flex align-items-stretch"
									data-kt-search-keypress="true" data-kt-search-min-length="2"
									data-kt-search-enter="enter" data-kt-search-layout="menu"
									data-kt-menu-trigger="auto" data-kt-menu-overflow="false"
									data-kt-menu-permanent="true" data-kt-menu-placement="bottom-end">
									<!--begin::Search toggle-->
									<div class="d-flex align-items-stretch" data-kt-search-element="toggle"
										id="kt_header_search_toggle">

										<h1 class="fs-2tx fw-bolder text-primary mb-8 mt-auto">Faculty Feedback Portal
										</h1>

									</div>
									<!--end::Search toggle-->
								</div>
								<!--end::Search-->
							</div>
							<!--end::Search-->
						</div>
						<!--end::Toolbar wrapper-->
					</div>
					<!--end::Wrapper-->
				</div>
				<!--end::Container-->
			</div>
			<!--end::Header-->
			<!--begin::Container-->
			<div id="kt_content_container" class="d-flex flex-column-fluid align-items-stretch container-xxl">
				<!--begin::Aside-->
				<div id="kt_aside" class="aside" data-kt-drawer="true" data-kt-drawer-name="aside"
					data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true"
					data-kt-drawer-width="{default:'200px', '300px': '225px'}" data-kt-drawer-direction="start"
					data-kt-drawer-toggle="#kt_aside_toggle" data-kt-sticky="true" data-kt-sticky-name="aside-sticky"
					data-kt-sticky-offset="{default: false, lg: '1px'}" data-kt-sticky-width="{lg: '225px'}"
					data-kt-sticky-left="auto" data-kt-sticky-top="94px" data-kt-sticky-animation="false"
					data-kt-sticky-zindex="95">
					<!--begin::Aside nav-->
					<div class="hover-scroll-overlay-y my-5 my-lg-5 w-100 ps-4 ps-lg-0 pe-4 me-1"
						id="kt_aside_menu_wrapper" data-kt-scroll="true"
						data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-height="auto"
						data-kt-scroll-dependencies="#kt_header" data-kt-scroll-wrappers="#kt_aside"
						data-kt-scroll-offset="5px">
						<!--begin::Menu-->
						<div class="menu menu-column menu-active-bg menu-hover-bg menu-title-gray-700 fs-6 menu-rounded w-100"
							id="#kt_aside_menu" data-kt-menu="true">
							<!--begin::Heading-->
							<div class="menu-item">
								<div class="menu-content pb-2">
									<span class="menu-section text-muted text-uppercase fs-7 fw-bolder">Menu</span>
								</div>
							</div>
							<!--end::Heading-->
							<!--begin::Menu item-->
							<div class="menu-item mb-2">
								<a href="/" class="menu-link text-hover-primary ">
									<span class="menu-title"><i class="fi fi-rr-home fs-3"></i>
										<pre> </pre><span class="ml-5"> Home</span></span>
								</a>
							</div>
							<!--end::Menu item-->
							<!--begin::Menu item-->
							<div class="menu-item mb-2">
								<a href="/reports" class="menu-link active">
									<span class="menu-title"><i class="fi fi-rr-document fs-3 text-primary"></i>
										<pre> </pre><span class="text-primary ml-5"> Reports</span></span>
								</a>
							</div>
							<!--end::Menu item-->
							<!--begin::Menu item-->
							<div class="menu-item mb-2">
								<a href="/settings" class="menu-link text-hover-primary">
									<span class="menu-title"><i class="fi fi-rr-settings fs-3"></i>
										<pre> </pre><span class="ml-5"> Settings</span></span>
								</a>
							</div>
							<!--end::Menu item-->
							<!--begin::Menu item-->
							<div class="menu-item mb-2">
								<a class="menu-link text-hover-primary" id="logout">
									<span class="menu-title"><i class="fi fi-rr-sign-out-alt fs-3"></i>
										<pre> </pre><span>Logout</span></span>
								</a>
							</div>
							<!--end::Menu item-->
						</div>
						<!--end::Menu-->
					</div>
					<!--end::Aside nav-->
				</div>
				<!--end::Aside-->
				<!--begin::Wrapper-->
				<div class="wrapper d-flex flex-column flex-row-fluid mt-5 mt-lg-10" id="kt_wrapper">
					<!--begin::Content-->
					<div class="content flex-column-fluid" id="kt_content">
						<div class="card mb-5 mb-xl-8">
							<!--begin::Header-->
							<div class="card-header border-0 pt-5">
								<h3 class="card-title align-items-start flex-column">
									<span class="card-label fw-bolder fs-3 mb-1">
										Dear <%= user.name %>, <br><br>Reports for
										<%= user.year %> - <%= user.sem %> <%= user.branch.toUpperCase() %> -
										<%= user.section %>
								</h3>
							</div>
							<!--end::Header-->
							<!--begin::Body-->
							<div class="card-body py-3">
								<h1 class="text-info">Total Students - <%= users.length %></h1>
								<div class="chart">
									<div id="kt_docs_google_chart_pie"></div>
									<script type="text/javascript">
										// GOOGLE CHARTS INIT
										google.load('visualization', '1', {
											packages: ['corechart', 'bar', 'line']
										});

										google.setOnLoadCallback(function () {
											var data = google.visualization.arrayToDataTable([
												['Status', 'No of Students Completed'],
												['Completed', parseInt('<%= data.completed %>')],
												['Pending', parseInt('<%= data.pending %>')],
											]);

											var options = {
												title: 'Feedback Status',
												colors: ['#2abe81', '#fe3995'],
												width: 550,
												height: 500
											};

											var chart = new google.visualization.PieChart(document.getElementById('kt_docs_google_chart_pie'));
											chart.draw(data, options);
										});
									</script>
								</div>
								<h1 class="text-danger">Pending Students - <%= data.pending %></h1>
								<!--begin::Table container-->
								<div class="table-responsive">
									<!--begin::Table-->
									<table class="table table-row-bordered table-row-gray-100 align-middle gs-0 gy-3">
										<!--begin::Table head-->
										<thead>
											<tr class="fw-bolder text-muted">
												<th>Roll No</th>
												<th>Name</th>
											</tr>
										</thead>
										<!--end::Table head-->
										<!--begin::Table body-->
										<tbody>
											<% users.forEach(u => { %>
												<% if(!u.feedback) { %>
													<tr>
														<td><%= u.rollno %></td>
														<td><%= u.name %></td>
													</tr>
												<% } %>
											<% }) %>
										</tbody>
										<!--end::Table body-->
									</table>
									<!--end::Table-->
								</div>
								<!--end::Table container-->
								<h1 class="text-success">Completed Students - <%= data.completed %></h1>
								<!--begin::Table container-->
								<div class="table-responsive">
									<!--begin::Table-->
									<table class="table table-row-bordered table-row-gray-100 align-middle gs-0 gy-3">
										<!--begin::Table head-->
										<thead>
											<tr class="fw-bolder text-muted">
												<th>Roll No</th>
												<th>Name</th>
											</tr>
										</thead>
										<!--end::Table head-->
										<!--begin::Table body-->
										<tbody>
											<% users.forEach(u => { %>
												<% if(u.feedback) { %>
													<tr>
														<td><%= u.rollno %></td>
														<td><%= u.name %></td>
													</tr>
												<% } %>
											<% }) %>
										</tbody>
										<!--end::Table body-->
									</table>
									<!--end::Table-->
								</div>
								<!--end::Table container-->
							</div>
							<!--begin::Body-->
							<div class="card-footer py-3">
								<a onclick="gotoURL('/clear-feedback-status')" class="btn btn-primary ml-5">Clear
									Feedback Status</a>
							</div>
						</div>
					</div>
					<!--end::Content-->
					<!--begin::Footer-->
					<div class="d-flex flex-center flex-column-auto p-10">
						<!--begin::Links-->
						<div class="d-flex align-items-center fw-bold fs-6">
							<a href="#" class="text-muted fs-bolder px-2">SVCE Kadapa</a>
						</div>
						<!--end::Links-->
					</div>
					<!--end::Footer-->
				</div>
				<!--end::Wrapper-->
			</div>
			<!--end::Container-->
		</div>
		<!--end::Page-->
	</div>
	<!--end::Root-->
	<!--end::Main-->
	<!--begin::Javascript-->
	<script type="text/javascript">
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function () {
			if (this.readyState == 4 && this.status == 200) {
				const res = JSON.parse(xhttp.responseText);
				Swal.fire({
					text: res.message,
					icon: res.status,
					buttonsStyling: false,
					confirmButtonText: "Ok, got it!",
					customClass: {
						confirmButton: "btn btn-primary"
					}
				}).then(result => {
					if (result.isConfirmed) {
						location.reload("/");
					}
				});
			}
		}
		window.onload = function () {
			const button = document.getElementById("logout");

			button.addEventListener("click", (e) => {
				e.preventDefault();
				Swal.fire({
					text: "Do you want to logout?",
					icon: "info",
					buttonsStyling: false,
					confirmButtonText: "Ok, logout!",
					showCancelButton: true,
					customClass: {
						confirmButton: "btn btn-primary",
						cancelButton: "btn btn-danger"
					}
				}).then(result => {
					if (result.isConfirmed) {
						xhttp.open("GET", "/auth/logout");
						xhttp.setRequestHeader("Accept", "application/json");
						xhttp.setRequestHeader("Content-Type", "application/json");
						xhttp.send();
					}
				});
			});
		}

		function gotoURL(url) {
			Swal.fire({
				text: `Are you sure to perform this operation`,
				icon: "info",
				buttonsStyling: false,
				confirmButtonText: "Ok, Proceed!",
				showCancelButton: true,
				customClass: {
					confirmButton: "btn btn-primary",
					cancelButton: "btn btn-danger"
				}
			}).then(result => {
				if (result.isConfirmed) {
					xhttp.open("GET", url);
					xhttp.setRequestHeader("Accept", "application/json");
					xhttp.setRequestHeader("Content-Type", "application/json");
					xhttp.send();
				}
			});
		}
	</script>
	<!--begin::Global Javascript Bundle(used by all pages)-->
	<script src="/assets/plugins/global/plugins.bundle.js"></script>
	<script src="/assets/js/scripts.bundle.js"></script>
	<!--end::Global Javascript Bundle-->
	<!--end::Javascript-->
</body>
<!--end::Body-->

</html>